#! /bin/bash

# User configs
SRC_ROOT=/work/
VPS_SRC_ROOT=/work/ASUS/wildbook

#=============		MyPrint
# Color
Color_off='\033[0m'       # Text Reset
Black='\033[0;30m'              # Black黑
Red='\033[0;31m'                # Red
Green='\033[0;32m'              # Green绿
Yellow='\033[0;33m'             # Yellow黄
Blue='\033[0;34m'               # Blue蓝色
Purple='\033[0;35m'             # Purple紫色
SkyBlue='\033[0;36m'            # SkyBlue天蓝色
White='\033[0;37m'              # White白色

function MyPrint()
{
    echo -e "$1$2${Color_off}\t"
}


# command cd	<Project>
function switchProjects()
{
    echo "cd /work/$1"
    $(cd /work/;pwd)
}

# command make	<Project>
#=============		编译
function MakeProjects()
{
    echo "zore"
}

# command Repo <Project>
#=============		push
function Repo()
{
    #下代码
    #更新代码
    #
    case $1 in

    sku1)
        cd ${SRC_ROOT}/sku1
        ;;
    sku2-4)
        cd ${SRC_ROOT}/sku2-4
        ;;
    sku5)
        cd ${SRC_ROOT}/sku5
        ;;
    sku6-8)
        cd ${SRC_ROOT}/sku6-8
        ;;
    sku9-12)
        cd ${SRC_ROOT}/sku9-12
        ;;
    *) MyPrint $Red "Don't have this choise!"
    esac

    MyPrint $Green "repo sync -c --no-tags"
    repo sync -c --no-tags  -j8
}

# command Gitpush	<Project>
#=============		push
function GitPush() {
    case $1 in

    # flash aboot
    sku1)
        NAME="sku1-ZC600KL-dev"
        ;;
    sku2-4)
        NAME="sku2-4-ZD553KL-dev"
        ;;
    sku5)
        NAME="sku5-ZC553KL-dev"
        ;;
    sku6-8)
        NAME="sku6-8-ZC554KL-dev"
        ;;
    sku9-12)
        NAME="sku9-12-ZC520KL-dev"
        ;;
    app)
        NAME="asus_app_dev"
        ;;
    *) MyPrint $Red "Don't have this choise!"
    esac

    MyPrint $Green "git push origin HEAD:refs/for/${NAME}"
    git push origin HEAD:refs/for/${NAME}
}

# command flash	<Project>
#=============		刷机
function FlashImages()
{

    # 1. 判断是否重启
    # 2. 循环刷机
    # 3. 重启系统

    if [ -z $ANDROID_PRODUCT_OUT ]; then
        MyPrint $Red "please run \"source build/envsetup.sh\" in rootfs of source"
        exit
    fi

    #ANDROID_BUILD_TOP 代码根目录
    #ANDROID_PRODUCT_OUT
    #if [ -z android ];then
    #	mkdir -p /tmp/android
    #fi

    aNum=$1
    #case $1 in
    #	sku1)
    #		ANDROID_PRODUCT_OUT=/work/sku1/out/target/product/msm8937_64
    #	;;
    #	sku2)
    #		ANDROID_PRODUCT_OUT=/work/sku2/out/target/product/msm8937_64
    #	;;
    #	sku5)
    #		ANDROID_PRODUCT_OUT=/work/sku5/out/target/product/msm8937_64
    #	;;
    #	sku6)
    #		ANDROID_PRODUCT_OUT=/work/sku6/out/target/product/msm8937_64
    #	;;
    #	sku9)
    #		ANDROID_PRODUCT_OUT=/work/sku9/out/target/product/msm8937_64
    #	;;
    #	*)
    #		ANDROID_PRODUCT_OUT=/work/SKU5_BP_8940_O_sign_wingtech/out/target/product/msm8937_64
    #	;;
    #esac

    case $aNum in	#用循环解决这个问题

    # flash aboot
    aboot)  MyPrint $Green "flashing boot"
        sudo fastboot flash aboot $ANDROID_PRODUCT_OUT/emmc_appsboot.mbn
        ;;
    reaboot)  MyPrint $Green "rebooting && flashing aboot"
        adb reboot-bootloader && sudo fastboot flash aboot $ANDROID_PRODUCT_OUT/emmc_appsboot.mbn
        ;;

    # flash image
    boot|system|userdata|recovery|cache)
        MyPrint $Green "sudo fastboot flash $aNum $ANDROID_PRODUCT_OUT/$aNum.img"
        sudo fastboot flash $aNum $ANDROID_PRODUCT_OUT/$aNum.img
        ;;
    # reboot && flash image
    reboot|resystem|reuserdata|rerecovery|recache)
        MyPrint $Green "adb reboot-bootloader && sudo fastboot flash ${aNum:2} $ANDROID_PRODUCT_OUT/${aNum:2}.img"
        adb reboot-bootloader && sudo fastboot flash ${aNum:2} $ANDROID_PRODUCT_OUT/${aNum:2}.img
        ;;
    # flash modem
    *) MyPrint $Red "Don't have this choise!"
    esac

    echo -e "\nAll is download,do you want to reboot(y/n) ?"
    read x
    if [ "$x" == "y" ] || [ "$x" == "Y" ];then
        fastboot reboot
    fi
}

#=============		Test
function Test()
{
    echo $(pwd)
}

#=============		Scp
function Scp()
{
    NAME=archermind@10.20.11.11:/work/
    scp $(pwd)/$1   $NAME
}

#=============		远程登录
function ssh-login()
{
    case $1 in
    ##	firm ##
    sunqian|51)
        NAME=archermind@10.20.11.51
        ;;
    lize|183)
        NAME=archermind@10.20.11.183
        ;;
    chunhua|192)
        NAME=root@10.20.11.192 #111
        ;;
    youcun|21)
        NAME=archermind@10.20.11.21
        ;;
    songpeng|114)
        NAME=archermind@10.20.11.114
        ;;
    zhanglei|79)
        NAME=archermind@10.20.11.79
        ;;
    yanhua|23)
        NAME=archermind@10.20.11.23
        ;;
    fanjun|73)
        NAME=archermind@10.20.11.73
        ;;

    ##	firm server ##
    main|11)
        NAME=archermind@10.20.11.11
        ;;
    main0|10)
        NAME=archermind@10.20.11.10
        ;;
    main1|116)
        NAME=archermind@10.20.11.116
        ;;
    main2|56)
        NAME=archermind@10.20.11.56
        ;;
    main3|162)
        NAME=archermind@10.20.11.162
        ;;
    main4|151)
        NAME=archermind@10.20.11.151
        ;;
    main5|65)
        NAME=archermind@10.20.11.65
        ;;
    gitweb|93)
        NAME=archermind@10.20.11.93
        ;;

    ##	me ##
    vps)
        NAME="-p 28556 root@184.170.212.253"
        ;;
    vps1)
        NAME="-p 28556 root@184.170.212.253"
        ;;
    *) echo "ssh-login() Don't have this choise!"
    esac

    echo "ssh $NAME"
    ssh $NAME
    #scp xx $NAME:/work
    #scp $NAME:/work xx
}

#=============		help
function Usages()
{
    echo -e  "
    Usage: work [OPTION]... [URL]...

    -V,  --version           display the version of Wget and exit.
    -h,  --help              print this help.
    -s name     ssh
    -f image    fastboot flash
    -a          adb
    "

}

#if [ -z $1 ];then
#	Usages
#	exit
#elif ["-"!=${1:0:1}];then
#
#
#
#fi


#function GetOpts()
#{  
while getopts "s:f:p:t:h" OPTION; do
    case $OPTION in

    h)
        Usages
        ;;
    s)
        ssh-login $OPTARG
        ;;
    f)
        FlashImages $OPTARG
        ;;
    p)
        GitPush $OPTARG
        ;;
    t)
        Test
        ;;
    *)
        Usages
        ;;
    ?)
        echo "ssh"
        ;;

    esac
done
#}
